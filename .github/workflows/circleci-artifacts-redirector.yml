name: Run CircleCI artifacts redirector for rendered HTML
on: [status]
jobs:
   circleci_artifacts_redirector_job:
     runs-on: ubuntu-latest
     name: Run CircleCI artifacts redirector
     steps:
       - name: GitHub Action step
         uses: scientific-python/circleci-artifacts-redirector-action@839631420e45a08af893032e5a5e8843bf47e8ff  # v1.2.0
         with:
           repo-token: ${{ secrets.GITHUB_TOKEN }}
           api-token: ${{ secrets.PLZ_CIRCLE_CI }}
           artifact-path: 0/_build/html/index.html
           circleci-jobs: build-docs
           # https://github.com/scientific-python/circleci-proxy - this domain avoids some limitations that
           #  circleci has in terms of output files
           domain: circle.scientific-python.dev
           job-title: "--> Rendering Preview <--"
       - name: Check the URL
         if: github.event.status != 'pending'
         run: |
           curl --fail ${{ steps.step1.outputs.url }} | grep $GITHUB_SHA